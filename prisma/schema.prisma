generator client {
  provider = "prisma-client"
    output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                   String            @id @default(uuid())
  avatar               String?
  banner               String?
  name                 String
  email                String            @unique
  password             String?
  country              String?

  notification         Notification[]
  course               Course[]
  comments             Comments[]
  favoriteCourse       FavoriteCourse[]

  provider             AuthProvider      @default(LOCAL)
  role                 Role              @default(STUDENT)
}
enum AuthProvider {
  LOCAL
  GOOGLE
}
enum Role {
  STUDENT
  OWNER
}

model FavoriteCourse {
  id                   Int       @id @default(autoincrement())
  userId               String
  courseId             String

  createdAt            DateTime  @default(now())

  user                 User      @relation(fields: [userId], references: [id])
  course               Course    @relation(fields: [courseId], references: [id])

  @@unique([userId, courseId])
}

model Notification {
  id                   Int       @id @default(autoincrement())

  userId               String
  message              String

  read                 Boolean   @default(false)
  createdAt            DateTime  @default(now())

  user                 User      @relation(fields: [userId], references: [id])
}

model Course {
  id                   String    @id @default(uuid())
  theme                String
  description          String  
  title                String
  section              Json
  bottomText           String
  image                String
  price                Int
  userId               String
  createdAt            DateTime  @default(now())

  user                 User      @relation(fields: [userId], references: [id])
  category             String?
  lessons              Lessons[]
  favoriteCourse       FavoriteCourse[]
}

model Category {
  id                   String    @id @default(uuid())
  type                 String
  name                 String
}

model Lessons {
  id                   Int       @id @default(autoincrement())
  title                String
  courseId             String

  videos               Video[]

  course               Course    @relation(fields: [courseId], references: [id])
}

model Video {
  id                   Int       @id @default(autoincrement())
  title                String
  preview              String?
  videoUrl             String
  duration             Int       
  lessonsId            Int

  views                Int       @default(0) 
  lessons              Lessons   @relation(fields: [lessonsId], references: [id])

  comments             Comments[]
}
model Comments {
  id                   String    @id @default(uuid())
  text                 String
  timestamp            Int       // секунда видео, где оставлен комментарий
  userId               String
  videoId              Int

  createdAt            DateTime  @default(now())

  user                 User      @relation(fields: [userId], references: [id])
  video                Video     @relation(fields: [videoId], references: [id])
}